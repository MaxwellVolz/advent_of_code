import random

# input_text = 'Cricket is more similar to dust devils and landspouts. They form when a homicide rate of 34.2 per 100,000 was reported. This included 15 officer-involved shootings. One shooting led to the latest hour of it; and lately, I know of but love, desperate love, the worst of all the more remote islands. At around the field. One of Wollstonecraft’s most popular metaphors draw on military concepts: Disease is an early type of fiction that were quick to resort to violence. One of Wollstonecraft’s favorite arguments.'
# input_text = "Markov chains can be discrete or continuous. Discrete Time Markov Chains are split up into discrete time steps, like t = 1, t = 2, t = 3, and so on. The probability that a chain will go from one state to another state depends only on the state that it's in right now. Continuous Time Markov Chains are chains where the time spent in each state is a real number. The amount of time the chain stays in a certain state is randomly picked from an exponential distribution, which basically means there's an average time a chain will stay in some state, plus or minus some random variation."
# input_text = "It’s March 2015, and I am standing on the bridge of a starship. The crew work stations look worn, the walls are covered with warning signs, and the grated floor looks like something designed to be functional. If I didn’t know better, I’d think that I was standing on a real ship, hurtling through space. Instead, I am on the set of a new television series, a location that, until now, only existed in words on a page.“Do you want to see a shitty Belter ship?” Ty Franck asked our small group, leading us off of one set and pointing to an adjacent one. “Let’s go over there, that’s one of our shitty Belter ships.Leviathan Wakes is the start of an epic space opera series known as The Expanse, a series that has exploded in popularity since that talked-about debut. Critics have hailed it as a new form of classic space opera, complete with a well-built world, a rotating cast of interesting characters, and a killer story. There is plenty of action, and a deep exploration of how humans will act when we leave our own world for new ones. But more than that, it was selected by the Syfy network as the flagship of a new programming lineup designed to win over the same crowd that pushed the reimagined Battlestar Galactica to new-classic status."
input_text = "The Cat in the Hat By Dr. Seuss The sun did not shine. It was too wet to play. So we sat in the house All that cold, cold, wet day. I sat there with Sally. We sat there, we two. And I said, How I wish We had something to do! Too wet to go out And too cold to play ball. So we sat in the house. We did nothing at all. So all we could do was to Sit! Sit! Sit! Sit! And we did not like it. Not one little bit. BUMP! And then something went BUMP! How that bump made us jump! We looked! Then we saw him step in on the mat! We looked! And we saw him! The Cat in the Hat! And he said to us, Why do you sit there like that? I know it is wet And the sun is not sunny. But we can have Lots of good fun that is funny! I know some good games we could play, Said the cat. I know some new tricks, Said the Cat in the Hat. A lot of good tricks. I will show them to you. Your mother Will not mind at all if I do. Then Sally and I Did not know what to say. Our mother was out of the house For the day. But our fish said, No! No! Make that cat go away! Tell that Cat in the Hat You do NOT want to play. He should not be here. He should not be about. He should not be here When your mother is out! Now! Now! Have no fear. Have no fear! said the cat. My tricks are not bad, Said the Cat in the Hat. Why, we can have Lots of good fun, if you wish, with a game that I call UP-UP-UP with a fish! Put me down! said the fish. This is no fun at all! Put me down! said the fish. I do NOT wish to fall! Have no fear! said the cat. I will not let you fall. I will hold you up high As I stand on a ball. With a book on one hand! And a cup on my hat! But that is not ALL I can do! Said the cat... Look at me! Look at me now! said the cat. With a cup and a cake On the top of my hat! I can hold up TWO books! I can hold up the fish! And a litte toy ship! And some milk on a dish! And look! I can hop up and down on the ball! But that is not all! Oh, no. That is not all... Look at me! Look at me! Look at me NOW! It is fun to have fun But you have to know how. I can hold up the cup And the milk and the cake! I can hold up these books! And the fish on a rake! I can hold the toy ship And a little toy man! And look! With my tail I can hold a red fan! I can fan with the fan As I hop on the ball! But that is not all. Oh, no. That is not all.... That is what the cat said... Then he fell on his head! He came down with a bump From up there on the ball. And Sally and I, We saw ALL the things fall! And our fish came down, too. He fell into a pot! He said, Do I like this? Oh, no! I do not. This is not a good game, Said our fish as he lit. No, I do not like it, Not one little bit! Now look what you did! Said the fish to the cat. Now look at this house! Look at this! Look at that! You sank our toy ship, Sank it deep in the cake. You shook up our house And you bent our new rake. You SHOULD NOT be here When our mother is not. You get out of this house! Said the fish in the pot. But I like to be here. Oh, I like it a lot! Said the Cat in the Hat To the fish in the pot. I will NOT go away. I do NOT wish to go! And so, said the Cat in the Hat, So so so... I will show you Another good game that I know! And then he ran out. And, then, fast as a fox, The Cat in the Hat Came back in with a box. A big red wood box. It was shut with a hook. Now look at this trick, Said the cat. Take a look! Then he got up on top With a tip of his hat. I call this game FUN-IN-A-BOX, Said the cat. In this box are two things I will show to you now. You will like these two things, Said the cat with a bow. I will pick up the hook. You will see something new. Two things. And I call them Thing One and Thing Two. These Things will not bite you. They want to have fun. Then, out of the box Came Thing Two and Thing One! And they ran to us fast. They said, How do you do? Would you like to shake hands With Thing One and Thing Two? And Sally and I Did not know what to do. So we had to shake hands With Thing One and Thing Two. We shook their two hands. But our fish said, No! No! Those Things should not be In this house! Make them go! They should not be here When your mother is not! Put them out! Put them out! Said the fish in the pot. Have no fear, little fish, Said the Cat in the Hat. These Things are good Things. And he gave them a pat. They are tame. Oh, so tame! They have come here to play. They will give you some fun On this wet, wet, wet day. Now, here is a game that they like, Said the cat. They like to fly kites, Said the Cat in the Hat No! Not in the house! Said the fish in the pot. They should not fly kites In a house! They should not. Oh, the things they will bump! Oh, the things they will hit! Oh, I do not like it! Not one little bit! Then Sally and I Saw them run down the hall. We saw those two Things Bump their kites on the wall! Bump! Thump! Thump! Bump! Down the wall in the hall. Thing Two and Thing One! They ran up! They ran down! On the string of one kite We saw Mother's new gown! Her gown with the dots That are pink, white and red. Then we saw one kite bump On the head of her bed! Then those Things ran about With big bumps, jumps and kicks And with hops and big thumps And all kinds of bad tricks. And I said, I do NOT like the way that they play If Mother could see this, Oh, what would she say! Then our fish said, Look! Look! And our fish shook with fear. Your mother is on her way home! Do you hear? Oh, what will she do to us? What will she say? Oh, she will not like it To find us this way! So, DO something! Fast! said the fish. Do you hear! I saw her. Your mother! Your mother is near! So, as fast as you can, Think of something to do! You will have to get rid of Thing One and Thing Two! So, as fast as I could, I went after my net. And I said, With my net I can get them I bet. I bet, with my net, I can get those Things yet! Then I let down my net. It came down with a PLOP! And I had them! At last! Thoe two Things had to stop. Then I said to the cat, Now you do as I say. You pack up those Things And you take them away! Oh dear! said the cat, You did not like our game... Oh dear. What a shame! What a shame! What a shame! Then he shut up the Things In the box with the hook. And the cat went away With a sad kind of look. That is good, said the fish. He has gone away. Yes. But your mother will come. She will find this big mess! And this mess is so big And so deep and so tall, We ca not pick it up. There is no way at all! And THEN! Who was back in the house? Why, the cat! Have no fear of this mess, Said the Cat in the Hat. I always pick up all my playthings And so... I will show you another Good trick that I know! Then we saw him pick up All the things that were down. He picked up the cake, And the rake, and the gown, And the milk, and the strings, And the books, and the dish, And the fan, and the cup, And the ship, and the fish. And he put them away. Then he said, That is that. And then he was gone With a tip of his hat. Then our mother came in And she said to us two, Did you have any fun? Tell me. What did you do? And Sally and I did not know What to say. Should we tell her The things that went on there that day? Should we tell her about it? Now, what SHOULD we do? Well... What would YOU do If your mother asked YOU? Fox in Socks by Dr. Seuss Fox Socks Box Knox Knox in box. Fox in socks. Knox on fox in socks in box. Socks on Knox and Knox in box. Fox in socks on box on Knox. Chicks with bricks come. Chicks with blocks come. Chicks with bricks and blocks and clocks come. Look, sir. Look, sir. Mr. Knox, sir. Let's do tricks with bricks and blocks, sir. Let's do tricks with chicks and clocks, sir. First, I'll make a quick trick brick stack. Then I'll make a quick trick block stack. You can make a quick trick chick stack. You can make a quick trick clock stack. And here's a new trick, Mr. Knox.... Socks on chicks and chicks on fox. Fox on clocks on bricks and blocks. Bricks and blocks on Knox on box. Now we come to ticks and tocks, sir. Try to say this Mr. Knox, sir.... Clocks on fox tick. Clocks on Knox tock. Six sick bricks tick. Six sick chicks tock. Please, sir. I don't like this trick, sir. My tongue isn't quick or slick, sir. I get all those ticks and clocks, sir, mixed up with the chicks and tocks, sir. I can't do it, Mr. Fox, sir. I'm so sorry, Mr. Knox, sir. Here's an easy game to play. Here's an easy thing to say.... New socks. Two socks. Whose socks? Sue's socks. Who sews whose socks? Sue sews Sue's socks. Who sees who sew whose new socks, sir? You see Sue sew Sue's new socks, sir. That's not easy, Mr. Fox, sir. Who comes? ... Crow comes. Slow Joe Crow comes. Who sews crow's clothes? Sue sews crow's clothes. Slow Joe Crow sews whose clothes? Sue's clothes. Sue sews socks of fox in socks now. Slow Joe Crow sews Knox in box now. Sue sews rose on Slow Joe Crow's clothes. Fox sews hose on Slow Joe Crow's nose. Hose goes. Rose grows. Nose hose goes some. Crow's rose grows some. Mr. Fox! I hate this game, sir. This game makes my tongue quite lame, sir. Mr. Knox, sir, what a shame, sir. We'll find something new to do now. Here is lots of new blue goo now. New goo. Blue goo. Gooey. Gooey. Blue goo. New goo. Gluey. Gluey. Gooey goo for chewy chewing! That's what that Goo-Goose is doing. Do you choose to chew goo, too, sir? If, sir, you, sir, choose to chew, sir, with the Goo-Goose, chew, sir. Do, sir. Mr. Fox, sir, I won't do it. I can't say. I won't chew it. Very well, sir. Step this way. We'll find another game to play. Bim comes. Ben comes. Bim brings Ben broom. Ben brings Bim broom. Ben bends Bim's broom. Bim bends Ben's broom. Bim's bends. Ben's bends. Ben's bent broom breaks. Bim's bent broom breaks. Ben's band. Bim's band. Big bands. Pig bands. Bim and Ben lead bands with brooms. Ben's band bangs and Bim's band booms. Pig band! Boom band! Big"
class MarkovChain:
    def __init__(self):
        print("Hello!")

        test = self.build_model(input_text, 2)

        print(test)

        print(self.generate_text(test, 2, 20))

    def build_model(self, source, state_size):
        source = source.split()
        model = {}

        for i in range(state_size, len(source)):
            current_word = source[i]
            previous_words = " ".join(source[i - state_size : i])
            if previous_words in model:
                model[previous_words].append(current_word)
            else:
                model[previous_words] = [current_word]

        return model

    def generate_text(self, model, state_size, min_length):
        def get_new_starter():
            return random.choice([s.split(" ") for s in model.keys() if s[0].isupper()])

        text = get_new_starter()

        i = state_size
        while True:
            key = " ".join(text[i - state_size : i])
            if key not in model:
                text += get_new_starter()
                i += 1
                continue

            next_word = random.choice(model[key])
            text.append(next_word)
            i += 1
            if i > min_length and text[-1][-1] == ".":
                break

        return " ".join(text)


if __name__ == "__main__":
    MarkovChain()
